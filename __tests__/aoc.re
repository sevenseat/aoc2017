open Jest;

open Expect;

let day1 = "878938232157342756754254716586975125394865297349321236586574662994429894259828536842781199252169182743449435231194436368218599463391544461745472922916562414854275449983442828344463893618282425242643322822916857935242141636187859919626885791572268272442711988367762865741341467274718149255173686839265874184176985561996454253165784192929453678326937728571781212155346592432874244741816166328693958529938367575669663228335566435273484331452883175981955679335327231995452231118936393192583338222595982522833468533262224874637449624644318418748617949417939228988293391941457722641936417456243894182668197174255786445994567477582715692336249243254711653529871336129825735249667425238573952339922948214218872417858525199642194588448543565474847272984232637466664695217176358283788781843171636841215675851778984619377575696447366844854289534215286959727688419731976631323833892247438149829975856161755122857643731945913335556288817112993911694972667656914238999291831997163412548977649491227219477796124134958527843213824792685117696631512141241496451845758655276186597724748432996276498527911292531185292149948139724345841584782352214921634858734671118495424143437282979243347831258285851259579133433182387444656386679831584933397915132785411686688447731696776459621924821667112751789884987883991845818513249994767543526169463766975791464756526911587399764736557959464923353896921342944821833991457125256329564489631352268722457628514564128231487382111682976886838192412996932924373337524262135399256658638418515239876732866596731888779532573243713128238419234963195589987539467221517535272384899524386267268959484881379944796392255419838743164714275463459351741296586465213689853743856518583451849661592844879264196761867481258778393623584884535246239794178981387632311238115362178576899121425428114696158652976277392224226268242332589546757477683398264294929442592131949398261884548427951472128841328376819241955153423452531538413492577262348369581399925647624623868299468436859667152463974949436359589931136236247929554899679139746162554183855278713574244211854227829969443151478986413333429144796664423754818256172862812877688675514142265239992529776262844329188218189254491238956497568";

let day2 = [
  [
    5806,
    6444,
    1281,
    38,
    267,
    1835,
    223,
    4912,
    5995,
    230,
    4395,
    2986,
    6048,
    4719,
    216,
    1201
  ],
  [74, 127, 226, 84, 174, 280, 94, 159, 198, 305, 124, 106, 205, 99, 177, 294],
  [
    1332,
    52,
    54,
    655,
    56,
    170,
    843,
    707,
    1273,
    1163,
    89,
    23,
    43,
    1300,
    1383,
    1229
  ],
  [
    5653,
    236,
    1944,
    3807,
    5356,
    246,
    222,
    1999,
    4872,
    206,
    5265,
    5397,
    5220,
    5538,
    286,
    917
  ],
  [
    3512,
    3132,
    2826,
    3664,
    2814,
    549,
    3408,
    3384,
    142,
    120,
    160,
    114,
    1395,
    2074,
    1816,
    2357
  ],
  [
    100,
    2000,
    112,
    103,
    2122,
    113,
    92,
    522,
    1650,
    929,
    1281,
    2286,
    2259,
    1068,
    1089,
    651
  ],
  [
    646,
    490,
    297,
    60,
    424,
    234,
    48,
    491,
    245,
    523,
    229,
    189,
    174,
    627,
    441,
    598
  ],
  [
    2321,
    555,
    2413,
    2378,
    157,
    27,
    194,
    2512,
    117,
    140,
    2287,
    277,
    2635,
    1374,
    1496,
    1698
  ],
  [
    101,
    1177,
    104,
    89,
    542,
    2033,
    1724,
    1197,
    474,
    1041,
    1803,
    770,
    87,
    1869,
    1183,
    553
  ],
  [
    1393,
    92,
    105,
    1395,
    1000,
    85,
    391,
    1360,
    1529,
    1367,
    1063,
    688,
    642,
    102,
    999,
    638
  ],
  [
    4627,
    223,
    188,
    5529,
    2406,
    4980,
    2384,
    2024,
    4610,
    279,
    249,
    2331,
    4660,
    4350,
    3264,
    242
  ],
  [
    769,
    779,
    502,
    75,
    1105,
    53,
    55,
    931,
    1056,
    1195,
    65,
    292,
    1234,
    1164,
    678,
    1032
  ],
  [
    2554,
    75,
    4406,
    484,
    2285,
    226,
    5666,
    245,
    4972,
    3739,
    5185,
    1543,
    230,
    236,
    3621,
    5387
  ],
  [
    826,
    4028,
    4274,
    163,
    5303,
    4610,
    145,
    5779,
    157,
    4994,
    5053,
    186,
    5060,
    3082,
    2186,
    4882
  ],
  [588, 345, 67, 286, 743, 54, 802, 776, 29, 44, 107, 63, 303, 372, 41, 810],
  [
    128,
    2088,
    3422,
    111,
    3312,
    740,
    3024,
    1946,
    920,
    131,
    112,
    477,
    3386,
    2392,
    1108,
    2741
  ]
];

test("1.1", () =>
  DayOne.captcha(day1) |> expect |> toBe(1175)
);

test("1.2", () =>
  DayOne.part2(day1) |> expect |> toBe(1166)
);

test("2.1", () =>
  DayTwo.chsum(day2) |> expect |> toBe(47623)
);

test("2.2", () =>
  DayTwo.chDiv(day2) |> expect |> toEqual(Some(312))
);